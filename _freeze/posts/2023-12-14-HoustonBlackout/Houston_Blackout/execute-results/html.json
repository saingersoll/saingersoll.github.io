{
  "hash": "f706862ede829b29298e1c5607ce0f75",
  "result": {
    "markdown": "---\ntitle: \"Assessing the Toll: Residential Impact of February 2021 Blackouts in Houston, Texas\"\ndescription: \"Explore the aftermath of the February 2021 blackouts in Houston, Texas, as we delve into the impact on residential properties. This documentation provides insights into the extent of disruption experienced by homes during the blackout period, shedding light on the disproportionate challenges faced by residents, particularly in relation to median income levels.\"\nauthor: Sofia Ingersoll\ndate: \"2023-12-14\"\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show the code\"\nembed-resources: true\noutput:\n    html_document:\n      print_df: paged\n      toc: yes\n      toc_depth: 4\n      toc_float: yes\ncategories: [Geospatial Analysis, Power Outage]\n---\n\n::: {.cell}\n::: {.cell-output-display}\n![](medincome.png){width=922}\n:::\n:::\n\n\n# Exploring the Extent of Houston, TX Blackout\n\n## Shedding Light on the Disproportionate Challenges Residents Faced, Particularly in Relation to Median Income Levels\n\nThroughout the month of February in 2021, the state of Texas suffered a major power crisis, which came about as a result of three severe winter storms sweeping across the United States on February 10--11, 13--17, and 15--20.\"[^1] For more background, check out these [engineering](https://www.youtube.com/watch?v=08mwXICY4JM&ab_channel=PracticalEngineering) and [political](https://www.youtube.com/watch?v=Zcrsgdl_hP0&ab_channel=Vox) perspectives. For this project, we will estimate the number of homes in Houston that lost power as a result of the first two storms and investigate if socioeconomic factors are predictors of communities recovery from a power outage. Our analysis will be based on remotely-sensed night lights data, acquired from the [Visible Infrared Imaging Radiometer Suite (VIIRS)](https://en.wikipedia.org/wiki/Visible_Infrared_Imaging_Radiometer_Suite) onboard the Suomi satellite. In particular, we will use the VNP46A1 to detect differences in night lights before and after the storm to identify areas that lost electric power. To determine the number of homes that lost power, we will link (spatially join) these areas with [OpenStreetMap](https://www.openstreetmap.org/#map=4/38.01/-95.84) data on buildings and roads. By linking our analysis with data from the US Census Bureau we can investigate the potential socioeconomic factors that influenced recovery.\n\n[^1]: Wikipedia. 2021. \"2021 Texas power crisis.\" Last modified October 2, 2021. <https://en.wikipedia.org/wiki/2021_Texas_power_crisis>.\n\n#### Visualizing the Data\n\nThe following code is a walk through of how I developed the three visualizations included in the infographic created in Canva above. I would like to note that this is an early rendition of this infographic. I plan on expanding this personal project to investigate the water management district boundaries and evaluate the different types policies in place, or lack there of, that could be potential drivers of lower nutrient levels in estuaries.\n\n## Set up\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                            establish enva                                ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# set default chunk options\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\n\nlibrary(sf)\nlibrary(tmap)\nlibrary(here)\nlibrary(terra)\nlibrary(stars)\nlibrary(ggtext)\nlibrary(raster)\nlibrary(leaflet)\nlibrary(cowplot)\nlibrary(treemap)\nlibrary(showtext)\nlibrary(patchwork)\nlibrary(tidyverse)\nlibrary(sunburstR)\nlibrary(tmaptools)\n```\n:::\n\n\n## Load Data\n\n##### Night Lights\n\nWe'll be using NASA's Worldview to explore the data around the day of the storm. There are several days with too much cloud cover to be useful, but 2021-02-07 and 2021-02-16 provide two clear, contrasting images to visualize the extent of the power outage in Texas.\n\nVIIRS data is distributed through NASA's [Level-1 and Atmospheric Archive & Distribution System Distributed Active Archive Center (LAADS DAAC)](https://ladsweb.modaps.eosdis.nasa.gov/). Many NASA Earth data products are distributed in 10x10 degree tiles in sinusoidal equal-area projection. Tiles are identified by their horizontal and vertical position in the grid. Houston lies on the border of tiles h08v05 and h08v06. We therefore need to download two tiles per date.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                                import data                               ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Reading in the night light tif files\nVIIRS_05_07 <- read_stars(\"../data/houston/VNP46A1/VNP46A1.A2021038.h08v05.001.2021039064328.tif\")\nVIIRS_06_07 <- read_stars(\"../data/houston/VNP46A1/VNP46A1.A2021038.h08v06.001.2021039064329.tif\")\nVIIRS_05_16 <- read_stars(\"../data/houston/VNP46A1/VNP46A1.A2021047.h08v05.001.2021048091106.tif\")\nVIIRS_06_16 <- read_stars(\"../data/houston/VNP46A1/VNP46A1.A2021047.h08v06.001.2021048091105.tif\")\n```\n:::\n\n\n##### Highways\n\nTypically highways account for a large portion of the night lights observable from space (see Google's [Earth at Night](https://earth.google.com/web/@27.44405464,-84.7693044,206.63660162a,8916361.52264659d,35y,0h,0t,0r/data=CiQSIhIgMGY3ZTJkYzdlOGExMTFlNjk5MGQ2ZjgxOGQ2OWE2ZTc)). To minimize falsely identifying areas with reduced traffic as areas without power, we will ignore areas near highways.\n\n[OpenStreetMap (OSM)](https://planet.openstreetmap.org/) is a collaborative project which creates publicly available geographic data of the world. Ingesting this data into a database where it can be subsetted and processed is a large undertaking. Fortunately, third party companies redistribute OSM data. We used [Geofabrik's download sites](https://download.geofabrik.de/) to retrieve a shapefile of all highways in Texas and prepared a Geopackage (`.gpkg` file) containing just the subset of roads that intersect the Houston metropolitan area.Â \n\n-   `gis_osm_roads_free_1.gpkg`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                                import data                               ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# SQL query to aid in the data loading process\nquery <- \"SELECT* FROM gis_osm_roads_free_1 WHERE fclass='motorway'\"\n\n# Loading in the data with the SQL query\nhighways <- st_read(\"../data/houston/gis_osm_roads_free_1.gpkg\",\n                    query = query,\n                    quiet = TRUE)\n\n# Re-projecting CRS\nhighways <- highways %>% \n  st_transform(3083) %>% \n  st_make_valid(highways)\n```\n:::\n\n\n##### Buildings\n\nWe can also obtain building data from OpenStreetMap. We downloaded from Geofabrick and prepared a GeoPackage containing only houses in the Houston metropolitan area.\n\n-   `gis_osm_buildings_a_free_1.gpkg`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                                import data                               ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# SQL Query to aid in data loading process\nbuilding_query <- \"SELECT*\nFROM gis_osm_buildings_a_free_1\nWHERE (type IS NULL AND name IS NULL)\nOR type in ('residential', 'apartments', 'house', 'static_caravan', 'detached')\"\n\n# Loading in the building data with the query\nbuildings <- st_read(\"../data/houston/gis_osm_buildings_a_free_1.gpkg\",\n                     query = building_query,\n                     quiet = TRUE)\n```\n:::\n\n\n##### Census\n\nWe cannot readily get socioeconomic information for every home, so instead we obtained data from the [U.S. Census Bureau's American Community Survey](https://www.census.gov/programs-surveys/acs) for census tracts in 2019. The *folder* `ACS_2019_5YR_TRACT_48.gdb` is an ArcGIS [\"file geodatabase\"](https://desktop.arcgis.com/en/arcmap/latest/manage-data/administer-file-gdbs/file-geodatabases.htm), a multi-file proprietary format that's roughly analogous to a GeoPackage file.\n\nThe geodatabase contains a layer holding the geometry information, separate from the layers holding the ACS attributes. You have to combine the geometry with the attributes to get a feature layer that `sf` can use.\n\n### Read in Socioeconomic Data with sf\n\nUsing `st_read()` to load the geodatabase layers and `st_layers()` to explore the contents of the geodatabase. Each layer contains a subset of the fields documents in the [ACS metadata](https://www2.census.gov/geo/docs/maps-data/data/tiger/prejoined/ACSMetadata2011.txt). Geometries are stored in the `ACS_2019_5YR_TRACT_48_TEXAS` layer, income data is stored in the `X19_INCOME` layer, and the median income field `B19013e1.`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                                import data                               ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Loading geometry data\nsocioeconomic <- st_read(\"../data/houston/ACS_2019_5YR_TRACT_48_TEXAS.gdb\", layer = \"ACS_2019_5YR_TRACT_48_TEXAS\",\n                         quiet = TRUE)  \n\n# Loading income data and renaming the columns\nincome <- st_read(\"../data/houston/ACS_2019_5YR_TRACT_48_TEXAS.gdb\", layer = \"X19_INCOME\",\n                  quiet = TRUE) %>%\n  dplyr::select(GEOID, B19013e1) %>% \n  rename(GEOID_Data = GEOID,\n         median_income = B19013e1)\n```\n:::\n\n\n## Wrangling & Subsetting\n\n##### Night Lights\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                              wrangle data                                ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----          combine tiles          ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Combining tiles for each date as a stars object\nfeb_07 <- st_mosaic(VIIRS_05_07, VIIRS_06_07)\nfeb_16 <- st_mosaic(VIIRS_05_16, VIIRS_06_16)\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----           make a mask           ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Creating a mask to identify locations that experienced a drop greater than 200 nW cm-2sr-1\nblackout_locations <- (feb_07 - feb_16) > 200\n\n# Assigning non-blackout locations to be NA values\nblackout_locations[blackout_locations == FALSE] <- NA\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----          vectorize  mask        ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Transforming the mask into a vector and fixing improper geometries\nvector_blackout_locations <- st_as_sf(blackout_locations) %>% \n  st_make_valid()\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----            crop for AOI         ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Defining the Area of Interest\nhouston <- st_polygon(list(rbind(c(-96.5, 29),\n                                 c(-96.5, 30.5),\n                                 c(-94.5, 30.5),\n                                 c(-96.5, 29))))\n\n# Creating a sfc and assigning the CRS to match the vector blackout data\nhouston <- st_sfc(houston) %>% \n  st_set_crs(4326) %>% \n  st_make_valid()\n\n# cropping blackout locations to the houston dimensions\nhouston_blackout_mask <- st_crop(vector_blackout_locations, houston)\n\n# Re-projecting to match the maps\nhouston_blackout_mask <- houston_blackout_mask %>% \n  st_transform(3083) %>% \n  st_make_valid()\n```\n:::\n\n\n##### Highways\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                              wrangle data                                ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----          create buffer          ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Creating a 200 m buffer and dissolving it as a single object\nhighway_buffer <- st_buffer(highways, dist = 200) \n\n# combines the geometries within the buffer as one geometric polygon\nhighway_buffer <- st_union(highway_buffer)\n\n# identifying homes boardering the buffer and beyond the buffer\nhouston_blackout_highways <- st_difference(houston_blackout_mask, highway_buffer)\n```\n:::\n\n\n##### Buildings\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                              wrangle data                                ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----          CRS Correction         ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Re-projecting the dataset to match map\nbuildings <- buildings %>%\n  st_transform('EPSG:3083')\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----      isolate affected areas     ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Filtering for homes beyond the buffer zone affected by the blackouts\nhouston_blackout_homes <- st_join(buildings, houston_blackout_highways,\n                                  .predicate = st_intersects)\n\n# the number of homes impacted was displayed as 487405\n#nrow(houston_blackout_homes)\n```\n:::\n\n\n##### Census\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                              wrangle data                                ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----           combo for AOI         ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Combining the data for area of interest\ncensus_income <- left_join(socioeconomic, income, by = \"GEOID_Data\") %>%\n  st_transform('EPSG:3083') \n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----          CRS Correction         ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Re=projecting CRS\nhouston <- houston %>% \n  st_transform(3083)\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----            crop for AOI         ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Cropping the data \nhouston_income <- st_crop(census_income, houston)\n\n# Census tracts that experienced blackout\nblackout_census <- houston_blackout_homes[houston_income,] %>% \n  mutate(blackout = 'yes')\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----           combo for AOI         ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Combining Cropped datums\nhouston_blackout_combined <- st_join(houston_income, blackout_census, left = TRUE)\n```\n:::\n\n\n## Affected Areas \n\nCreating final combined subsets\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                           data for mapping                               ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----      isolate affected areas     ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# identifying homes boardering the buffer and beyond the buffer\nhouston_blackout_highways <- st_difference(houston_blackout_mask, highway_buffer)\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----   identifying unimpacted areas  ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Additional check to track impact of blackout\nhouston_blackout_combined$VNP46A1.A2021038.h08v05.001.2021039064328.tif[is.na(houston_blackout_combined$VNP46A1.A2021038.h08v05.001.2021039064328.tif)] <- \"FALSE\"\n\n# labels unaffected areas\nhouston_blackout_combined$blackout[is.na(houston_blackout_combined$blackout)] <- \"no\"\n\n# isolates unaffected areas into data subset\nno_blackout <- st_as_sf(houston_blackout_combined[!grepl(\"yes\",houston_blackout_combined$blackout),])\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----        categorizing areas       ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# Tracking blackouts\ntrac_with_blackout <- houston_blackout_combined%>%\n  filter(houston_blackout_combined$VNP46A1.A2021038.h08v05.001.2021039064328.tif == TRUE)\n\n# Tracking no blackouts\ntrac_without_blackout <- houston_blackout_combined%>%\n  filter(houston_blackout_combined$VNP46A1.A2021038.h08v05.001.2021039064328.tif == FALSE)\n```\n:::\n\n\n## Customs\n\n#### Text\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----                        create plot labels                            ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----          violin labels          ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nv_title <- \"Median Income vs Percentile Earning Group\"\nv_subtitle <- \"Homes in Houston, TX Affected by Blackouts\"\nv_alt <- \"This is a violin plot of homes impacted by the Houston, TX blackouts (2/21), the median income of the households affected separated into quantiles. A trend of increased blackouts were experienced by individuals earning a median income of less than or equal to 100 thousand dollars.\"\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----            map labels           ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nm_title <- \"Homes in Houston Affected by Blackouts, Median Income\"\n#m_subtitle <- \"Identifying <span style='color:#34A0A4;'>**Oligotrophic**</span> Estuaries\"\nm_legend <- \"Median Income\"\nm_alt <- \"This is a map of the homes within Houston, TX that experienced a blackout. The census tracts are colored based on median income quantiles. There is a wide spread distribution of areas that were impacted. The greatest regions that experienced a blackout were in the 25th and 50th percentiles.\"\n```\n:::\n\n\n#### Typeface\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----                        plot customizations                           ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----              fonts              ----  \n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# enable {showtext} for rendering \nshowtext_auto()\n# import fonts \nfont_add_google(name = \"Josefin Sans\", family = \"josefin\")\nfont_add_google(name = \"Sen\", family = \"sen\")\n```\n:::\n\n\n## Visuals\n\n### Figure 1: Understanding Demographics Affected\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# subset data for plotting\nviolin_data <- trac_with_blackout %>% \n  select(median_income, Shape) %>% \n  na.omit(median_income) %>% \n  mutate(\n    percentile_group = ntile(median_income, n = 4),\n    percentile_group = case_when(\n      percentile_group == 1 ~ \"25th Percentile\",\n      percentile_group == 2 ~ \"50th Percentile\",\n      percentile_group == 3 ~ \"75th Percentile\",\n      percentile_group == 4 ~ \"95th Percentile\"\n    )\n  )\n\nggplot(violin_data, aes(x = rev(factor(percentile_group)), y = median_income)) + \n  \n  geom_violin(aes(fill = factor(rev(percentile_group)))) +  \n # geom_jitter(shape = 16, position = position_jitter(0.2)) +\n  scale_fill_viridis_d(option = \"magma\", name = \"Median Income Percentile Group\") +\n  \n  labs(\n    x = \"Percentile Group\",\n    y = \"Median Income ($)\",\n    title = v_title,\n    subtitle = v_subtitle,\n    alt = v_alt\n  ) +\n  \n  scale_y_continuous(labels = scales::dollar_format()) +\n  \n  theme_classic() +\n  \n  theme(\n    plot.title = element_markdown(family = \"josefin\",\n                              face = \"bold\",\n                              size = 20,\n                              hjust = 0.5,\n                              vjust = 65),\n    \n     plot.subtitle = element_text(family = \"sen\",\n                                 size = 15,\n                                 hjust = 0.5),\n    \n    \n    axis.text.x = element_text(family = \"josefin\",\n                               face = \"bold\",\n                               size = 12,\n                               angle = 0,\n                               vjust = 0.8),\n    \n    axis.text.y = element_text(family = \"josefin\",\n                               face = \"bold\",\n                               size = 13,\n                               angle = 0,\n                               vjust = 0.8),\n    \n    axis.title.y = element_blank(),\n    \n    axis.title.x = element_blank(),\n    \n    legend.position = \"none\",\n    \n    # legend text customs \n    legend.text = element_text(family = \"josefin\",\n                               size = 12),\n    \n    # match my website colors\n    plot.background = element_rect(color = '#FDFBF7',\n                                   fill = '#FDFBF7'),\n    \n    panel.background = element_rect(color = '#FDFBF7',\n                                    fill = '#FDFBF7'),\n    # space on the side of the plot\n    plot.margin = margin(t = 1, r = 2, b = 1, l = 1, \"cm\")\n    \n    )\n```\n\n::: {.cell-output-display}\n![](Houston_Blackout_files/figure-html/unnamed-chunk-14-1.png){width=1152}\n:::\n:::\n\n\n### Figure 2: Comparing Tracts Impacted\n\n\n::: {.cell}\n\n```{.r .cell-code}\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n# ----          impacted areas         ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\ntmap_mode('view')\n#census tracts with blackouts\nblackout_map <-  tm_shape(trac_with_blackout) + \n  \n  tm_basemap(leaflet::providers$OpenStreetMap) + \n  \n  tm_polygons(fill = \"median_income\", \n              title = \"Median Income ($)\",\n              style = 'quantile',\n              n = 4,\n              palette = \"magma\",\n              alpha = 0.5) +\n  \n  #tm_borders() +\n  \n  tm_title(text = \"Median Income for Census Tracts With Blackouts\") +\n  \n  tm_scalebar(position = c('left','bottom')) +\n  \n  tm_layout(\n    \n    alt.text = m_alt,\n    \n    main.title.fontface = \"Josefin Sans\",\n    \n    main.title.fontfamily = \"josefin\",\n    \n  )\n \nblackout_map\n```\n:::",
    "supporting": [
      "Houston_Blackout_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}